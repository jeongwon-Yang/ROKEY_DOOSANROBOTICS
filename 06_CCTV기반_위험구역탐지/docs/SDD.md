시스템 설계 문서 (SDD)
프로젝트 제목: 정신병원/요양원을 위한 CCTV 기반 위험 구역 탐지
	버전: 1.0
날짜: 2025년 2월 20일

1. 개요
이 시스템 설계 문서는 정신병원과 요양원에서 환자의 탈출 및 위험 상황을 모니터링하고 예방하기 위한 CCTV 기반 경계 탐지 시스템의 아키텍처, 구성 요소, 데이터 흐름을 상세히 설명합니다.
이 시스템은 야간 근무에 초점을 맞추고 있으며, 이는 다음과 같은 이유 때문입니다:
    • 야간에는 인력 부족으로 인해 환자 모니터링이 어려움
    • 근무자의 피로 증가로 인해 감시 정확도가 저하됨
    • 환자가 야간에 시설을 벗어날 경우 매우 위험한 상황이 발생할 수 있음
주요 목표
    1. 자동 모니터링: CCTV 카메라를 사용하여 주요 구역을 지속적으로 감시
    2. 실시간 감지: 경량 YOLOv8n 모델을 사용하여 **위험한 상황(예: 환자의 탈출 시도)**을 신속하게 식별
    3. 즉각적인 대응: 비상 상황 발생 시, 로봇(AMR)이 현장에 출동하여 상황을 확인하고 대응
    4. 효율적인 자원 활용: Jetson Orin Nano, Open CR 등의 로컬 서버 또는 에지 장치에서 실행하여 실시간 추론과 최소한의 지연 시간을 유지

2. 시스템 아키텍처
이 시스템은 CCTV 영상, YOLOv8n을 실행하는 추론 서버(또는 에지 장치), **현장 검증 및 추적을 위한 자율 이동 로봇(AMR)**을 통합합니다.

+---------------+       (1) 실시간 비디오
|  CCTV Camera  |-----------------------------+
+---------------+                             |
                                              v
                             +-------------------------+
                             |  추론 서버 / 에지 장치  |
                             |  (YOLOv8n)              |
                             +-----------+-------------+
                             (2) /result_Yolo_cctv
                                         |
                                         v
                             +------------------------+
                             |  AMR (자율 이동 로봇)  |
                             |  - /robot/status      |
                             +------------------------+
2.1 구역 설정
    • 병원 내부는 6개의 구역(Zone 1~6)으로 나뉨
    • 비상 감시 구역: 탈출 가능성이 가장 높은 Zone 6
    • CCTV 카메라 배치: Zone 6을 완벽히 감시할 수 있도록 카메라를 하향 각도로 설치

3. 구성 요소 설계
3.1 CCTV 노드
    • 입력/출력 주제
        ◦ 게시: /Img_raw_cctv (약 30 FPS의 비디오 피드)
    • 하드웨어/환경
        ◦ 적절한 위치에 설치하고 삼각대에 고정
3.2 추론 서버 / 에지 장치 (YOLOv8n)
    • YOLOv8n을 선택한 이유
        ◦ Jetson Orin Nano, Raspberry Pi, 로컬 x86 서버에서 경량 및 실시간 성능 제공
    • 핵심 기능
        ◦ 구독: /Img_raw_cctv
        ◦ 실행: YOLOv8n을 이용한 위험 물체 및 환자 감지
        ◦ 게시:
            ▪ /result_Yolo_cctv: 탐지 신뢰도가 임계값 이상일 경우 "긴급" 경보 발송
성능 목표
    • 30 FPS 추론
    • 탐지 신뢰도 80-90% 임계값 유지, 오탐율 1% 미만 목표
    • RGB 값을 기반으로 재식별 수행 → YOLO가 대상을 놓칠 경우 색상 정보를 활용하여 신속한 재탐지 수행
3.3 AMR (자율 이동 로봇)
    • 하드웨어
        ◦ 온보드 컴퓨터 (Jetson Orin Nano, Open CR x86 시스템)
        ◦ LiDAR, IMU 또는 깊이 카메라
        ◦ 병원 복도에서 원활한 이동을 위한 모터 컨트롤러
    • 소프트웨어
        ◦ ROS2 (Humble) 기반 통신
        ◦ Nav2 활용 자율 내비게이션
        ◦ 필요 시 로컬 YOLO 감지 기능 추가 가능
    • 핵심 기능
        ◦ 구독
            ▪ /result_Yolo_cctv: 위험 감지 신호 및 RGB 값
            ▪ /Img_Yolo_cctv: 감지된 위험 구역 정보
            ▪ /robot/status: 로봇의 현재 상태
        ◦ 게시
            ▪ /robot/status: "대기" 또는 "위험 지역으로 이동" 또는“추적”
            ▪ /bounding_box/center: 로봇 내비게이션을 위한 좌표
            ▪ /cmd_vel: 속도 명령 (Nav2 출력)

4. 데이터 흐름 설계
4.1 CCTV 탐지 및 경보 기능
    1. CCTV 노드
        ◦ /Img_raw_cctv에 30 FPS 비디오 송출
    2. YOLO 추론 노드
        ◦ /cctv/image_raw을 구독 후 위험 물체 및 환자 감지
        ◦ 감지 시 /result_Yolo_cctv에 "긴급" 알람 전송
        ◦ /Img_Yolo_cctv에 감지 정보 게시
    3. AMR 상태 확인
        ◦ /robot/status 확인 후 대기 상태라면 출동 준비

4.2 로봇 이동 및 위험 좌표 수신
    • /result_Yolo_cctv 수신 후 위험 지역(Zone 6)으로 이동
    • 로컬 YOLO 사용 시 /Img_Yolo_AMR 활성화
    • /robot/status: "ready_to_move" 설정 후 출동

4.3 로봇 추적 및 탐지
    1. AMR 카메라 & YOLO
        ◦ /Img_Yolo_AMR을 구독하여 추가 탐지 수행
    2. 모션 제어
        ◦ /bounding_box/center 데이터 기반 속도 명령 생성 → /cmd_vel
    3. 추적 데이터 기록
        ◦ /cmd_vel을 활용하여 대상 정렬
        ◦ 중앙 DB 또는 서버에 "tracking" 상태 기록

5. 보안 및 규정 준수
    • 개인정보 보호
        ◦ 비대상 환자의 얼굴 자동 블러 처리
        ◦ 병원 직원만 접근 가능하도록 접근 제한
    • 규정 준수
        ◦ 병원 데이터 저장 규정 준수 (HIPAA, GDPR 등)

6. 성능 및 확장성
    • 실시간 감지: 30 FPS 유지
    • 저지연 경보: 감지 후 1초 이내 알람 전송
    • 로봇 출동 시간: 2초 이내

7. 배포 및 유지보수
    • 배포 절차
        ◦ ROS2, YOLOv8n 설치 및 CCTV 연동
        ◦ AMR 탐색 및 내비게이션 설정
    • 유지보수 일정
        ◦ 주간 점검 (카메라, 로봇, 서버 로그 확인)
        ◦ 월간 업데이트 (YOLO 모델 및 보안 패치 적용)

결론
이 SDD는 정신병원 및 요양원에서 CCTV를 활용한 자동 모니터링 및 로봇 기반 대응 시스템을 설계한 문서입니다. 실시간 탐지, 빠른 경보, 안전한 운영을 목표로 하며, RGB 기반 재탐지 기술을 활용하여 추적 성능을 강화하였습니다.
